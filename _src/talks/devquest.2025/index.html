<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="utf-8">
	<title>L‚Äôinvasion du HTML mutant</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="L‚Äôinvasion du HTML mutant ‚Äî conf√©rence donn√©e par Ga√´l Poupard lors du DevQuest Niort 2025.">
	<meta name="author" content="Ga√´l Poupard">
	<link rel="icon" href="../favicon.svg" type="image/svg+xml">
	<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="../accesslide/fonts/bello-pro.woff2">
	<link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="../accesslide/fonts/museo-slab-300.woff2">
	<link rel="stylesheet" href="../sliide/sliide.css?5" type="text/css" media="screen">
	<style>
		@font-face {
			font-display: swap;
			font-family: 'Twemoji Mozilla';
			font-style: normal;
			font-weight: 400;
			src: local('Twemoji Mozilla'), url('../devfest.2024/jeu/assets/fonts/Twemoji.woff2') format('woff2');
		}

		@font-palette-values --syntaxHighlighter {
			font-family: 'FontWithASyntaxHighlighter';
			override-colors:
				0 var(--foreground),
				4 rebeccapurple,
				5 var(--accent),
				7 var(--muted);
		}

		@font-face {
			font-display: swap;
			font-family: 'FontWithASyntaxHighlighter';
			src: url('../devfest.2024/jeu/assets/fonts/FontWithASyntaxHighlighter-Regular.woff2') format('woff2');
		}

		pre code {
			color: #fafafa;
			font-family: 'FontWithASyntaxHighlighter', monospace;
			font-palette: --syntaxHighlighter;
			outline: 0;
		}

		p code {
			font-family: 'FontWithASyntaxHighlighter', monospace;
			font-palette: --syntaxHighlighter;
		}

		.portrait {
			font-size: 80vw;
			text-align: center;
		}

		@media screen and (min-width: 60rem) {
			.portrait {
				font-family: 'Twemoji Mozilla', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji', sans-serif;
				font-size: 80vh;
				inset-block-start: 10vh;
				inset-inline-end: 10vh;
				line-height: 80vh;
				position: absolute;
				text-align: start;
			}
		}

		dialog {
			background: inherit;
			border-color: #000;
			border-radius: .5rem;
			box-shadow: 0 0 10rem #000;
			max-inline-size: clamp(50vw, 100%, 67.5rem);
		}

		dialog::backdrop {
			backdrop-filter: grayscale(50%) blur(.25rem);
		}

		play-ground {
			background-color: color-mix(in srgb, #231745 75%, #000);
			border-radius: .5rem;
			contain: strict;
			margin: 1rem;
			overflow: hidden;
			position: relative;
		}

		play-ground::before {
			font-family: 'Twemoji Mozilla', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji', sans-serif;
			font-size: calc(100vh + 10rem);
			line-height: calc(100vh + 10rem);
			inset: -5rem;
			position: absolute;
		}

		play-ground[type="zombie"]::before {
			content: 'üåÜ';
		}

		play-ground[type="villain"]::before {
			content: 'üåâ';
			mix-blend-mode: soft-light;
		}

		play-ground[type="invaders"] {
			background-color: #000;
			counter-reset: invaders;
		}

		@counter-style invasion {
			system: numeric;
			symbols: "0" "1" "2" "3" "4" "5" "6" "7" "8" "9";
			pad: 5 "0";
			speak-as: numbers;
		}

		play-ground[type="invaders"]::after {
			content: "score\A" counter(invaders, invasion);
			font-family: "FontWithASyntaxHighlighter", monospace;
			font-weight: bold;
			inset-block-start: 2rem;
			inset-inline-end: 2rem;
			position: absolute;
			text-transform: uppercase;
			white-space: pre;
		}

		play-ground[type="ghost"]::before {
			content: 'üåÅ';
		}

		play-ground[type="mage"]::before {
			content: 'üèîÔ∏è';
		}

		play-ground[type="skull"]::before {
			content: 'üå´Ô∏è';
			mix-blend-mode: soft-light;
		}

		play-ground[type="vampire"]::before {
			content: 'üåÉ';
		}

		play-ground[type="all"]::before {
			content: 'üåå';
		}

		mu-tant {
			aspect-ratio: 1;
			block-size: 6rem;
			display: inline-flex;
			font-family: 'Twemoji Mozilla', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji', sans-serif;
			font-size: 4rem;
			place-content: center;
			position: absolute;
		}

		code-runner {
			background:
				local linear-gradient(to right, #231745 30%, transparent) 0 0/2.5rem 100% no-repeat,
				local linear-gradient(to right, transparent, #231745 70%) 100%/2.5rem 100% no-repeat,
				scroll radial-gradient(farthest-side at 0% 50%, #000, transparent) 0 0/1rem 100% no-repeat,
				#231745 scroll radial-gradient(farthest-side at 100% 50%, #000, transparent) 100%/1rem 100% no-repeat;
			display: block;
			inline-size: 100%;
			overflow-x: scroll;
			overflow-y: hidden;
			-webkit-overflow-scrolling: touch;
			scroll-snap-type: both mandatory;
		}

		@media screen and (min-width: 60rem) {
			play-ground {
				min-block-size: calc(100vh - 2rem);
			}
		}

		@layer animation {
			/* @fixme La r√©partition dans le playground n‚Äôest pas assez vari√©e */
			mu-tant {
				--direction: 1;
				inset-block-start: clamp(0%, var(--placement, 50) * 1%, 100%);
				inset-inline-start: clamp(0%, var(--placement, 50) * 1%, 100%);
				transform: translateX(0) translateY(0);
			}

			mu-tant:nth-child(odd) {
				--direction: -1;
				inset-inline-start: clamp(0%, var(--placement, 50) * .5%, 50%);
			}

			mu-tant:nth-child(3n +1) {
				inset-inline-start: clamp(50%, var(--placement, 50) * 1%, 100%);
				scale: .75;
			}

			mu-tant:nth-child(4n +1) {
				inset-block-start: clamp(0%, var(--placement, 50) * .5%, 50%);
			}

			mu-tant:nth-child(5n +1) {
				inset-block-start: clamp(50%, var(--placement, 50) * 1%, 100%);
				scale: .5;
			}

			mu-tant:nth-child(6n +1) {
				inset-inline-start: clamp(50%, var(--placement, 50) * 1%, 100%);
			}

			@keyframes zombie {
				13% { transform: translateX(calc(12rem * var(--direction))) translateY(0); }
				26%, 78% { transform: translateX(calc(12rem * var(--direction))) translateY(calc(12rem * var(--direction))); }
				39% { transform: translateX(calc(24rem * var(--direction))) translateY(calc(12rem * var(--direction))); }
				52% { transform: translateX(calc(24rem * var(--direction))) translateY(calc(24rem * var(--direction))); }
				65% { transform: translateX(calc(12rem * var(--direction))) translateY(calc(24rem * var(--direction))); }
				91% { transform: translateX(0) translateY(calc(12rem * var(--direction))); }
			}

			mu-tant[type="zombie"] {
				animation: zombie 48s steps(48, end) infinite;
			}

			@keyframes ghost {
				10%, 90% { transform: translateX(calc(4rem * var(--direction))) translateY(6rem); }
				20%, 80% { transform: translateX(calc(8rem * var(--direction))) translateY(0); }
				30%, 70% { transform: translateX(calc(12rem * var(--direction))) translateY(6rem); }
				40%, 60% { transform: translateX(calc(16rem * var(--direction))) translateY(0); }
				50% { transform: translateX(calc(20rem * var(--direction))) translateY(6rem); }
			}

			@keyframes ghosting {
				50% { opacity: .5; }
			}

			mu-tant[type="ghost"] {
				animation: ghost 36s ease-out infinite, ghosting 3s ease-in infinite;
				opacity: 1;
			}

			@keyframes vampire {
				0% { transform: translateY(0) translateX(0) skewY(0); }
				5% { transform: translateY(calc(15rem * var(--direction))) translateX(0) skewY(25deg); }
				6%, 35% { transform: translateY(calc(15rem * var(--direction))) translateX(0) skewY(0); }
				40% { transform: translateY(calc(15rem * var(--direction))) translateX(calc(15rem * var(--direction))) skewY(25deg); }
				41%, 70% { transform: translateY(calc(15rem * var(--direction))) translateX(calc(15rem * var(--direction))) skewY(0); }
				75% { transform: translateY(calc(30rem * var(--direction))) translateX(calc(15rem * var(--direction))) skewY(25deg); }
				76%, 100% { transform: translateY(calc(30rem * var(--direction))) translateX(calc(15rem * var(--direction))) skewY(0); }
			}

			mu-tant[type="vampire"] {
				animation: vampire 6s linear infinite;
			}

			@keyframes invade {
				100% { transform: translateY(calc(100vh + 18rem)); }
			}

			@keyframes stepping {
				100% { scale: .75; }
			}

			mu-tant[type="invaders"] {
				animation: invade 24s ease-out 1 forwards, stepping 24s steps(12, end) 1 forwards;
				block-size: 2ex;
				counter-increment: invaders;
				inset-block-start: -6rem !important;
				inset-inline-start: auto !important;
				inline-size: 130%;
				letter-spacing: .25ch;
				scale: 1;
				text-align: center;
				text-indent: clamp(0ch, var(--placement, 50) * var(--direction) * .1ch, 20ch);
				white-space: nowrap;
			}

			/*
				@note Merci Barrett Sonntag
				@link https://codepen.io/sosuke/pen/Pjoqqp
			 */
			mu-tant[type="invaders"]:nth-child(1n + 1) {
				filter: grayscale(100%) brightness(0%) invert(15%) sepia(90%) saturate(5339%) hue-rotate(6deg) brightness(96%) contrast(127%);
			}

			mu-tant[type="invaders"]:nth-child(2n + 1) {
				filter: grayscale(100%) brightness(0%) invert(66%) sepia(82%) saturate(4488%) hue-rotate(88deg) brightness(117%) contrast(129%);
			}

			mu-tant[type="invaders"]:nth-child(3n + 1) {
				filter: grayscale(100%) brightness(0%) invert(9%) sepia(90%) saturate(7442%) hue-rotate(247deg) brightness(91%) contrast(149%);
			}

			mu-tant[type="invaders"]:nth-child(4n + 1) {
				filter: grayscale(100%) brightness(0%) invert(91%) sepia(27%) saturate(1428%) hue-rotate(1deg) brightness(110%) contrast(104%);
			}

			@keyframes villain {
				100% { transform: translateY(-15rem); }
			}

			mu-tant[type="villain"] {
				animation: villain 2s linear infinite;
				rotate: z calc(90deg * var(--direction));
			}

			mu-tant[type="troll"] span {
				display: inline-block;
				scale: .8;
			}
		}
	</style>
</head>
<body>
<main role="main" tabindex="0">
	<section id="slide-1" data-note="5m" class="d-flex flex-column justify-between">
		<h1>L‚Äôinvasion du <abbr title="HyperText Markup Language">html</abbr> mutant</h1>
		<dl>
			<dt>Slides en ligne</dt>
			<dd><a href="https://www.ffoodd.fr/devquest.2025/">ffoodd.fr/devquest.2025/</a></dd>
			<dt>Le jeu r√©alis√© pour le devFest Nantes 2024</dt>
			<dd><a href="https://www.ffoodd.fr/devfest.2024/jeu/">ffoodd.fr/devfest.2024/jeu/</a></dd>
		</dl>
		<footer>
			<div class="d-flex">
				<p class="my-0">Anim√© par <a href="https://www.ffoodd.fr">Ga√´l Poupard</a></p>
				<ul role="list">
					<li><a href="https://www.ffoodd.fr">
						<img src="../accesslide/img/ffoodd.svg" alt="Blog de Ga√´l Poupard" height="32" width="32">
					</a></li>
					<li><a href="https://mamot.fr/@ffoodd">
						<img src="../accesslide/img/mastodon.svg" alt="@ffoodd sur Mastodon" height="32" width="32">
					</a></li>
					<li><a href="https://github.com/ffoodd/">
						<img src="../accesslide/img/github.svg" alt="@ffoodd sur Github" height="32" width="32">
					</a></li>
					<li><a href="https://www.linkedin.com/in/ga%C3%ABl-poupard-40117b30/">
						<img src="../accesslide/img/linkedin.svg" alt="Ga√´l Poupard sur Linkedin" height="32" width="32">
					</a></li>
					<li><a href="https://www.paris-web.fr/">
						<img src="../accesslide/img/pw.svg" alt="Paris Web" height="32" width="32">
					</a></li>
				</ul>
			</div>
			<p>
				<a href="https://www.groupeonepoint.com">
					<img src="../accesslide/img/onepoint.svg" width="166" height="80" alt="onepoint">
				</a>
			</p>
		</footer>
	</section>

	<section id="slide-2" data-note="5m">
		<h2>L‚Äôinspecteur</h2>
		<p class="lead">On pourrait l‚Äôappeler Harry ou Gadget.</p>
		<div class="grid-2">
			<div class="portrait" aria-hidden="true">üïµüèø</div>
			<div>
				<p>L‚Äôinspecteur d√©veloppe des sites et applications web, et doit jongler avec une multitude de contextes.</p>
				<p>Et r√©guli√®rement, il doit utiliser les outils √† sa disposition pour corriger le tir&nbsp;!</p>
				<p>D√©marrez votre inspecteur, avec <kbd>F12</kbd> ou <kbd>Maj</kbd>+<kbd>Ctrl</kbd>+<kbd>i</kbd>.</p>
			</div>
		</div>
	</section>

	<section id="slide-4" data-note="5m">
		<h2>Les outils</h2>
		<p class="lead">L‚Äôinspecteur n‚Äôa pas de flingue, il a une API&nbsp;!</p>
		<div class="portrait" aria-hidden="true">üî´</div>
		<p>Nous allons nous servir d‚Äôun <code>MutationObserver</code>. Quelques r√®gles&nbsp;:</p>
		<ol>
			<li>Il faut l‚Äôinstancier&nbsp;: <code>const observer = new MutationObserver()</code>.</li>
			<li>Il faut lui donner un cible&nbsp;: <code>observer.observe(document.querySelector('#cible'), ‚Ä¶)</code>.</li>
			<li>Il lui faut une fonction de rappel&nbsp;: <code>observer.observe(‚Ä¶, callback)</code>.</li>
			<li>Il faut le d√©brancher, √† un moment&nbsp;: <code>observer.disconnect()</code>.</li>
		</ol>
	</section>

	<section id="slide-6" data-note="8m">
		<h2>Le zombie</h2>
		<p class="lead">Entrons dans le vif du sujet&nbsp;!</p>
		<div class="grid-2">
			<div class="portrait" aria-hidden="true">üßü</div>
			<div>
				<h3>Cas d‚Äôusage</h3>
				<p>
					Songez √† tous ces attributs qui peuvent √™tre importants&nbsp;:
					<code>hidden</code>, <code>aria-label</code>, <code>aria-invalid</code>‚Ä¶
				</p>
			</div>
		</div>
	</section>

	<section id="slide-7" data-note="3m">
		<h2 role="presentation">Le zombie</h2>
		<div class="grid-2">
			<code-runner type="json">
				<form>
					<label for="options" class="sr-only">
						Options de la m√©thode <code>observe()</code>, dont le premier argument
						est <code>document.querySelector("mu-tant")</code>.
					</label>
					<pre role="presentation"><code>observer.observe(document.querySelector("mu-tant"), {</code></pre>
					<input type="text" id="options"
								 autocomplete="off"
								 autocorrect="off"
								 autocapitalize="none"
								 spellcheck="false"
								 enterkeyhint="send"
								 required>
					<pre role="presentation"><code>});</code></pre>
					<p><button>Feu&nbsp;!</button></p>
				</form>
			</code-runner>
			<play-ground type="zombie"></play-ground>
		</div>
	</section>

	<section id="slide-8" data-note="8m">
		<h2>Le vilain</h2>
		<p class="lead">Et oui, il n‚Äôy a pas que des gentils, dans la vie.</p>
		<div class="portrait" aria-hidden="true">ü¶πüèø</div>
	</section>

	<section id="slide-9" data-note="3m">
		<h2>Les changements textuels</h2>
		<p class="lead">Quoi de pire qu‚Äôun changement au sein d‚Äôun n≈ìud texte, franchement&nbsp;?</p>
		<pre><code>characterData: true</code></pre>
		<h3>Cas d‚Äôusage</h3>
		<p>
			Imaginez un peu&nbsp;: un bouton dont l‚Äôintitul√© change, mais pas d‚Äô√©tat ni de classe auxquels s‚Äôaccrocher&nbsp;?
			Ou mieux, vous faites vos <i lang="en">slides</i> en HTML, avec une vue pr√©sentateur que vous
			voulez synchroniser sur votre pagination.
		</p>
	</section>

	<section id="slide-10" data-note="8m">
		<h2>L‚Äôalien</h2>
		<p class="lead">Ils sont parmi nous&nbsp;!</p>
		<div class="portrait" aria-hidden="true">üëæ</div>
	</section>

	<section id="slide-11" data-note="3m">
		<h2>Les changements de descendance directe</h2>
		<p class="lead">Les enfants, √ßa ne tient pas en place&nbsp;!</p>
		<pre><code>childList: true</code></pre>
		<h3>Cas d‚Äôusage</h3>
		<p>
			Un contenu inject√© inopin√©ment ‚Äî&nbsp;au hasard,
			lors d‚Äôun <i lang="en">scroll</i> infini&nbsp;‚Äî c‚Äôest irritant&nbsp;! Ou encore&nbsp;: une <code>iframe</code>
			dont vous devriez ajuster la hauteur en fonction de son contenu‚Ä¶
		</p>
		<p class="small">Ceci n‚Äôest pas inspir√© de faits r√©els, √©videmment&nbsp;!</p>
	</section>

	<section id="slide-12" data-note="8m">
		<h2>Le fant√¥me</h2>
		<p class="lead">Vous n‚Äôavez pas entendu un truc&nbsp;?</p>
		<div class="portrait" aria-hidden="true">üëª</div>
	</section>

	<section id="slide-13" data-note="3m">
		<h2>Quand il y a trop d‚Äôattributs‚Ä¶</h2>
		<p class="lead">Il faut choisir&nbsp;!</p>
		<pre><code>attributeFilter: ['id']</code></pre>
		<h3>Cas d‚Äôusage</h3>
		<p>
			Imaginez un <i lang="en">framework</i> qui indique l‚Äô√©tat invalide d‚Äôun champ de formulaire
			avec une classe, mais sans <code>aria-invalid</code>&nbsp;? Vous savez comment <i lang="en">patcher</i> √ßa,
			maintenant.
		</p>
		<p class="small">Toute ressemblance avec des <i lang="en">frameworks</i> serait purement fortuite.</p>
	</section>

	<section id="slide-14" data-note="8m">
		<h2>Le sorcier</h2>
		<p class="lead">Il faut se m√©fier des types encapuchonn√©s<br>avec un grand b√¢ton.</p>
		<div class="portrait" aria-hidden="true">üßôüèø</div>
	</section>

	<section id="slide-15" data-note="3m">
		<h2>Les changements de descendance profonde</h2>
		<p class="lead">Il n‚Äôy a pas que les parents pour surveiller les enfants&nbsp;: tous leurs a√Øeux le peuvent.</p>
		<pre><code>childList: true, subtree: true</code></pre>
		<h3>Cas d‚Äôusage</h3>
		<p>
			Le saviez-vous&nbsp;? Un WebComponent ne peut pas √©mettre un √©v√©nement en disparaissant‚Ä¶
			Donc si vous voulez d√©clencher quelque chose, vous saurez comment faire&nbsp;!
		</p>
	</section>

	<section id="slide-16" data-note="8m">
		<h2>Le vampire</h2>
		<p class="lead">Il faut aussi se m√©fier des types avec un sourire qui d√©borde.</p>
		<div class="portrait" aria-hidden="true">üßõüèø</div>
	</section>

	<section id="slide-17" data-note="3m">
		<h2>Les valeurs disparues</h2>
		<p class="lead">Se souvenir du pass√©, √ßa peut aider.</p>
		<pre><code>attributeOldValue: true</code></pre>
		<pre><code>mutation.oldValue.includes('mutant')</code></pre>
		<p>On peut aussi affiner&nbsp;:</p>
		<pre><code>mutation.attributeName === 'class'</code></pre>
		<h3>Cas d‚Äôusage</h3>
		<p>
			Vous avez connu l‚Äô√©poque des classes <code>.open</code> et <code>.show</code>
			pour afficher ou masquer un √©l√©ment ‚Äî&nbsp;et aucun autre changement dans le DOM&nbsp;?
			Ou un script tiers qui fait des trucs sans √©mettre d‚Äô√©v√©nements&nbsp;?
		</p>
		<p class="small">Bien entendu, ce sujet est une pure fiction.</p>
	</section>

	<section id="slide-18" data-note="8m">
		<h2>Le vieillissement</h2>
		<p class="lead">Vous ne l‚Äôaviez pas vu venir, hein&nbsp;?</p>
		<div class="portrait" aria-hidden="true">‚ò†Ô∏è</div>
	</section>

	<section id="slide-19" data-note="3m">
		<h2>Les caract√®res disparus</h2>
		<p class="lead">C‚Äôest presque un cercle, les caract√®res disparus.</p>
		<pre><code>characterDataOldValue: true</code></pre>
		<pre><code>mutation.oldValue === 'üíÄ'</code></pre>
		<h3>Cas d‚Äôusage</h3>
		<p>
			Un composant de cr√©ation de mot de passe qui enl√®ve la description des contraintes franchies‚Ä¶
			Vous n‚Äôavez jamais vu √ßa&nbsp;?
		</p>
	</section>

	<section id="slide-20" data-note="8m">
		<h2>Le boss final</h2>
		<p class="lead">C‚Äôest le moment de sauver des vies.</p>
		<div class="portrait" aria-hidden="true">üéÜ</div>
	</section>

	<section id="slide-21" data-note="5m">
		<h2>Les solutions</h2>
		<h3>Le bazooka</h3>
		<pre><code>document.querySelectorAll('mu-tant:not([type=""])')
	.forEach(mutant => mutant.remove());</code></pre>
		<h3>Le pr√©cautionneux</h3>
		<pre><code>if (mutation.target.nodeName === 'MU-TANT' && mutation.target.type !== '') {
	mutation.target.remove();
} else if (mutation.target.closest('mu-tant') !== undefined) {
	mutation.target.closest('mu-tant').remove();
}</code></pre>
		<p>
			Malgr√© toutes les options, on peut avoir du mal √† trier les mutations.
			Fort √† propos, le type <code>MutationRecord</code> dispose de tout un tas de propri√©t√©s bien utiles.
		</p>
	</section>

	<section id="slide-22">
		<h2>Mais encore&nbsp;?</h2>
		<p class="lead">Les <code>MutationObserver</code> ne sont pas seuls&nbsp;!</p>
		<ul>
			<li>
				Les <code>IntersectionObserver</code> permettent de surveiller les collisions
				visuelles entre √©l√©ments&nbsp;;
			</li>
			<li>
				Les <code>ResizeObserver</code> permettent de surveiller les changements
				de dimensions d‚Äôun √©l√©ment&nbsp;;
			</li>
			<li>
				Les <code>PerformanceObserver</code> permettent de surveiller diff√©rents
				indicateurs de performance et de les consigner dans les <i lang="en">logs.</i>
			</li>
		</ul>
	</section>

	<section id="slide-23">
		<h2>Merci</h2>
		<h3>Et √† bient√¥t <span aria-hidden="true">&nbsp;&#128522;</span></h3>
		<div class="grid-2">
			<div>
				<h4>Cr√©dits</h4>
				<ul>
					<li>Emojis&nbsp;: <a hreflang="en" href="https://github.com/twitter/twemoji">Twemoji</a> ‚Äî&nbsp;par Twitter&nbsp;;</li>
					<li>Typographie de titraille&nbsp;: <a hreflang="en" href="https://typekit.com/fonts/bello-pro">Bello Pro</a> ‚Äî&nbsp;cr√©√©e par <a hreflang="en" href="https://www.underware.nl/">Underware</a>&nbsp;;</li>
					<li>Typographie de labeur&nbsp;: <a hreflang="en" href="https://typekit.com/fonts/museo-slab">Museo Slab</a> ‚Äî&nbsp;cr√©√©e par <a hreflang="en" href="https://www.exljbris.com/">Exljbris</a>&nbsp;;</li>
					<li>Moteur de pr√©sentation inspir√© de <a hreflang="en" href="https://css-tricks.com/css-scroll-snap-slide-deck/">"<cite lang="en">CSS scroll-snap slide deck that supports live coding</cite>" de Stephanie Eckles sur Smashing Magazine</a>.</li>
				</ul>
			</div>
			<!--<div class="m-auto">
				<h4>Laissez votre <i lang="en">feedback</i></h4>
				<p><a href="https://openfeedback.io/">
					<img src="../img/qr.svg" alt="Openfeedback" width="400" height="400" loading="lazy">
				</a></p>
			</div>-->
		</div>
	</section>
</main>

<dialog id="portal" role="dialog" aria-labelledby="portal-heading">
	<h2 id="portal-heading">Bien jou√©&nbsp;!</h2>
	<p>Un cas tordu de moins&nbsp;: on passe au suivant&nbsp;?</p>
	<form method="dialog">
		<button>Continuer</button>
	</form>
</dialog>
<dialog id="game-over" role="dialog" aria-labelledby="game-over-heading">
	<h2 id="game-over-heading" lang="en">Game over</h2>
	<p>
		Vous avez √©t√© submerg√©&nbsp;! Pour vous √©pargner (et √©vider de faire fondre votre navigateur),
		vous √™tes pri√©s de recommencer le niveau‚Ä¶
	</p>
	<form method="dialog">
		<button>Rejouer</button>
	</form>
</dialog>
<dialog id="replay" role="dialog" aria-labelledby="replay-heading">
	<h2 id="replay-heading">Rat√©&nbsp;!</h2>
	<p>
		Vos options n‚Äôont pas fonctionn√©‚Ä¶ Nouvelle chance&nbsp;?
	</p>
	<form method="dialog">
		<button>Rejouer</button>
	</form>
</dialog>

<div class="timer" style="--duration: 120;">
	<div class="clock" role="presentation">
		<span style="--time: 3600s"></span>h&nbsp;
		<span style="--time: 60s"></span>m&nbsp;
		<span style="--time: 1s"></span>s
	</div>
</div>

<script src="../devfest.2024/jeu/mu-tant.js"></script>
<script src="../devfest.2024/jeu/code-runner.js"></script>
<script src="../devfest.2024/jeu/play-ground.js"></script>
<script>
	let view;
	switchSlide = (id) => {
		// Historique
		history.pushState({}, "", `#slide-${id}`);
		// Vue pr√©sentateur
		//// Aper√ßu du slide suivant
		document.body.style.setProperty('--next', String(`-moz-element(#slide-${Number(id) + 1})`));
		//// Synchro de la vue pr√©sentateur
		if (view) {
			view.postMessage(`slide-${id}`, `http://localhost:8080${document.location.pathname}index.html`);
		}
		//// Notes dans la vue pr√©sentateur
		if('note' in document.getElementById(`slide-${id}`).dataset) {
			document.body.dataset.note = document.getElementById(`slide-${id}`).dataset.note;
		} else {
			delete document.body.dataset.note;
		}
	}

	document.addEventListener('DOMContentLoaded', () => {
		const slides = document.querySelectorAll('section[id^="slide-"]');

		// Nombre total de slides, pour la pagination
		document.body.style.setProperty('--slides', String(slides.length));
		document.body.style.setProperty('--next', String(`-moz-element(#slide-2)`));

		// Gestion de l‚Äôhistorique
		let io = new IntersectionObserver(entries => {
			if (entries[0].isIntersecting === true) {
				switchSlide(entries[0].target.id.split('-')[1]);
			}
		}, {
			root: document.querySelector('main'),
			threshold: [1]
		});
		slides.forEach(slide =>	io.observe(slide));

		document.addEventListener('keydown', event => {
			const index = Number(window.location.hash.split('-')[1]);
			let id = null;
			switch (event.key) {
				// Activer la vue pr√©sentateur
				case 's':
					if (event.altKey) {
						view = window.open(`http://localhost:8080${document.location.pathname}index.html`, 'speakerView');
						view.addEventListener('load', () => {
							view.document.body.classList.add('speaker');
						})
					}
					break;
				// T√©l√©commande ++
				case 'PageDown':
					id = index + 1;
					break;
				// T√©l√©commande --
				case 'PageUp':
					id = index - 1;
					break;
				default:
					break;
			}

			if (id !== null && id >= 1) {
				document.getElementById(`slide-${id}`).scrollIntoView({ behavior: 'smooth' });
				switchSlide(id);
			}
		});
	});

	window.addEventListener('message', (e) => {
		if (e.origin === 'http://localhost:8080/') {
			document.getElementById(e.data).scrollIntoView({ behavior: 'smooth' });
			switchSlide(e.data.split('-')[1]);
		}
	}, false);
</script>
</body>
</html>
