<!doctype html>
<html lang="fr">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Navigation, Aria et WordPress</title>
		<meta name="description" content="">
		<link rel="icon" href="/favicon.svg" type="image/svg+xml">
		<!-- @todo Ajouter le flux RSS
			<link rel="alternate" type="application/rss+xml" title="La vie en #ffoodd | Flux RSS" href="/feed/">
		-->
	</head>
	<body class="tk-museo-slab" itemscope itemtype="https://schema.org/WebPage">
		<a class="skip scroll pa1 inbl smaller print-hidden" href="#content">Aller au contenu</a>
		<div class="row">
			<nav class="col txtright pt8 w-33 pl0 pr0 print-hidden" id="nav" role="navigation">
				<ul class="menu aside p-reset m-reset ul-reset">
					<!-- @todo GÃ©rer lâ€™Ã©tat current -->
					<li class="tk-bello-pro h1-like m-reset current-menu-item current_page_item">
						<a href="/" aria-current="page">ffoodd</a>
					</li>
					<li class="h3-like m-reset"><a href="/plus/">Ã€ propos</a></li>
					<!-- @todo gÃ©rer lâ€™URL ? -->
					<li class="h3-like m-reset"><a href="/category/journal/">Journal</a></li>
					<li class="h3-like m-reset"><a href="/travaux/">Parcours</a></li>
				</ul>
			</nav><!-- / #nav -->

			<main class="col w--site pl3 pb3 pr5" id="content" role="main" role="main" itemprop="mainContentOfPage">
				<div class="logo print-hidden">
					<img src="/images/2013/10/copy-cropped-ffoodd.png" alt="La vie en #ffoodd" id="logo" width="144" height="144">
				</div>
				
					<p>Dans sa version basique, la navigation de WordPress nâ€™a rien de particulier (si ce nâ€™est la multitude de classes gÃ©nÃ©rÃ©es sur chaque Ã©lÃ©ment ğŸ™ ). Or ARIA permet dâ€™ajouter une couche sÃ©mantique non nÃ©gligeable et relativement simple Ã  mettre en place, amÃ©liorant ainsi lâ€™accessibilitÃ© de la navigation.</p>
<h2>Notre objectif</h2>
<p>Lâ€™implÃ©mentation dâ€™ARIA sur une navigation est simple â€ bien quâ€™il soit assez compliquÃ© dâ€™en trouver une documentation ou un exemple concret. Voici le rÃ©sultat attendu sur ffoodd (je vous Ã©pargne les classes et identifiants, pour cette fois ğŸ˜‰ ) :</p>
<pre><code class="language-markup">&lt;nav id=&quot;nav&quot; role=&quot;navigation&quot;&gt;
  &lt;ul role=&quot;menubar&quot;&gt;
  &lt;li role=&quot;menuitem&quot; aria-labelledby=&quot;ffoodd&quot;&gt;
  &lt;a href=&quot;https://www.ffoodd.fr&quot; id=&quot;ffoodd&quot;&gt;ffoodd&lt;/a&gt;
  &lt;/li&gt;
  &lt;li role=&quot;menuitem&quot; aria-labelledby=&quot;travaux&quot;&gt;
  &lt;a href=&quot;https://www.ffoodd.fr/travaux/&quot; id=&quot;travaux&quot;&gt;Travaux&lt;/a&gt;
  &lt;/li&gt;
  &lt;/ul&gt; 
&lt;/nav&gt;
</code></pre>
<p>Vous connaissiez sans doute dÃ©jÃ  le rÃ´le Â«Â navigationÂ Â», qui identifie la zone majeure du contenu destinÃ©e Ã  la navigation. Les autres rÃ´le et attributs sont explicites, et on en saisit facilement lâ€™intÃ©rÃªt sur cet extrait de code. Voyons maintenant comment obtenir ce rÃ©sultat avec WordPress.</p>
<h2>WordPress et le Walker dÃ©diÃ© Ã  la navigation</h2>
<p>Ce sympathique walker se nomme <strong>Walker_Nav_Menu</strong>. Je lâ€™avais rencontrÃ© la premiÃ¨re fois en farfouillant dans le code de <a href="http://themefortress.com/reverie/" title="Reverie - un starter theme pour WordPress (nouvelle fenÃªtre)">Reverie</a>, sans en saisir lâ€™intÃ©rÃªt Ã  lâ€™Ã©poque. Puis mes compÃ©tences et rÃ©flexions Ã©voluant avec le temps, lorsque je le recroisais sur le blog de <a href="https://twitter.com/willybahuaud" title="Willy Bahuaud sur Twitter (nouvelle fenÃªtre)">Willy Bahuaud</a> dans <a href="http://wabeo.fr/blog/construire-walker-wordpress/" title="Construire un walker WordPress (nouvelle fenÃªtre)">son article prÃ©sentant les walkers</a>, jâ€™en saisis rapidement lâ€™intÃ©rÃªt et me mit en tÃªte de mâ€™en servir sur mon thÃ¨me ffeeeedd.</p>
<p>Je vous recommande chaudement de lire lâ€™article de Willy sur le sujet, qui est une entrÃ©e en matiÃ¨re extrÃªmement intÃ©ressante.</p>
<h2>Les mains dans le code</h2>
<p>VoilÃ  sans plus attendre le code obtenu aprÃ¨s quelques recherche :</p>
<pre><code class="language-php">  /* == @section AmÃ©lioration de la navigation ==================== */
  /**
 * @note : Un walker nous permet de amnipuler le html gÃ©nÃ©rÃ© pour la navigation afin dâ€™y ajouter les roles aria qui vont bien.
 * @author : GaÃ«l Poupard
 * @see : https://twitter.com/ffoodd_fr
 * @see : http://wabeo.fr/blog/construire-walker-wordpress/
 * @author : Willy Bahuaud
 * @see : http://core.trac.wordpress.org/browser/tags/3.6.1//wp-includes/nav-menu-template.php#L0
 */
  class ffeeeedd__walker extends Walker_Nav_Menu {
  function start_el( &amp;$output, $item, $depth = 1, $args = array(), $id = 0 ) {
  $indent = ( $depth ) ? str_repeat( &quot;\t&quot;, $depth ) : â€™â€™;

  $class_names = $value = â€™â€™;

  $classes = empty( $item-&gt;classes ) ? array() : (array) $item-&gt;classes;
  $classes[] = â€™menu-item-â€™ . $item-&gt;ID;

  $class_names = join( â€™ â€™, apply_filters( â€™nav_menu_css_classâ€™, array_filter( $classes ), $item, $args ) );
  $class_names = $class_names ? â€™ class=&quot;â€™ . esc_attr( $class_names ) . â€™&quot;â€™ : â€™â€™;

  $id = apply_filters( â€™nav_menu_item_idâ€™, â€™menu-item-â€™. $item-&gt;ID, $item, $args );
  $id = $id ? â€™ id=&quot;â€™ . esc_attr( $id ) . â€™&quot;â€™ : â€™â€™;

  $output .= $indent . â€™&lt;liâ€™ . $id . $value . $class_names .â€™ role=&quot;menuitem&quot; aria-labelledby=&quot;item-â€™ . sanitize_html_class( apply_filters( â€™the_titleâ€™, $item-&gt;title, $item-&gt;ID ) ) . â€™&quot;&gt;â€™;

  $atts = array();
  $atts[â€™titleâ€™] = ! empty( $item-&gt;attr_title ) ? $item-&gt;attr_title : â€™â€™;
  $atts[â€™targetâ€™] = ! empty( $item-&gt;target ) ? $item-&gt;target : â€™â€™;
  $atts[â€™relâ€™] = ! empty( $item-&gt;xfn ) ? $item-&gt;xfn : â€™â€™;
  $atts[â€™hrefâ€™] = ! empty( $item-&gt;url ) ? $item-&gt;url : â€™â€™;

  $atts = apply_filters( â€™nav_menu_link_attributesâ€™, $atts, $item, $args );

  $attributes = â€™â€™;
  foreach ( $atts as $attr =&gt; $value ) {
    if ( ! empty( $value ) ) {
    $value = ( â€™hrefâ€™ === $attr ) ? esc_url( $value ) : esc_attr( $value );
    $attributes .= â€™ â€™ . $attr . â€™=&quot;â€™ . $value . â€™&quot;â€™;
    }
  }

  $item_output = $args-&gt;before;
  $item_output .= â€™&lt;aâ€™. $attributes .â€™ id=&quot;item-â€™ . sanitize_html_class( apply_filters( â€™the_titleâ€™, $item-&gt;title, $item-&gt;ID ) ) . â€™&quot;&gt;â€™;
  $item_output .= $args-&gt;link_before . apply_filters( â€™the_titleâ€™, $item-&gt;title, $item-&gt;ID ) . $args-&gt;link_after;
  $item_output .= â€™&lt;/a&gt;â€™;
  $item_output .= $args-&gt;after;

  $output .= apply_filters( â€™walker_nav_menu_start_elâ€™, $item_output, $item, $depth, $args );
  }
  }
</code></pre>
<p>Le walker manipule chaque niveau de rendu de la navigation, ce qui nous permet dâ€™ajouter les rÃ´les trÃ¨s facilement. La seule intervention astucieuse consiste Ã  rÃ©cupÃ©rer lâ€™intitulÃ© de lâ€™item afin de lâ€™utiliser comme label pour la navigation.</p>
<p>Et voilÃ  ! Simple, non ?</p>
<h2>Les Ã©volutions Ã  venir</h2>
<p>Bien quâ€™intÃ©ressante, cette astuce nâ€™est pas parfaite. En effet la spÃ©cification ARIA prÃ©voit des Ã©tats pour les Ã©lÃ©ments, afin dâ€™expliciter les interactions.</p>
<p>Dans notre cas, il va falloir appliquer lâ€™attribut boolÃ©en <strong>aria-selected</strong> sur les items de navigation, en passant sa valeur de true Ã  false selon lâ€™item actif.</p>
<p>Bien quâ€™ayant dÃ©jÃ  appliquÃ© ce comportement sur des boÃ®tes Ã  onglets notamment, jâ€™aimerais parvenir Ã  le faire sur ma navigation sans passer par du javascript. Jâ€™ai cherchÃ© des pistes pour utiliser le walker (qui Ã  priori devrait Ãªtre capable de repÃ©rer lâ€™item actif) mais sans rÃ©sultat pour le moment, donc <strong>nâ€™hÃ©sitez pas Ã  commenter lâ€™article ou Ã  me contacter par mail si vous avez la moindre piste Ã  me suggÃ©rer</strong> (voire mÃªme la solution, hein :D).</p>
<p>De plus, un comportement (en javascript Ã  priori) est Ã©galement Ã  prÃ©voir pour les sous-menu, qui pourront sâ€™avÃ©rer plus complexes Ã  gÃ©rer â€ bien quâ€™ARIA soit trÃ¨s complÃ¨te sur ce sujet.</p>

				
			</main>

			<aside class="col pt8 pl0 pr0 print-hidden" role="complementary">
				<div class="aside pl2 pt2">
					<h3 class="tk-bello-pro h2-like m-reset">Ã€ lire ailleurs</h3>
					<div class="textwidget">
						<ul>
							<li>
								<a href="https://openweb.eu.org/articles/du-consommateur-au-producteur">sur Openweb</a>
							</li>
							<li>
								<a href="https://www.alsacreations.com/livres/lire/1503-webgrids-structure-et-typographie-de-la-page-web.html">sur AlsacrÃ©ations</a>
							</li>
						</ul>
					</div>
					<h3 class="tk-bello-pro h2-like m-reset pt1">Ã€ regarder ailleurs</h3>
					<div class="textwidget">
						<ul>
							<li>
								<a href="https://www.paris-web.fr/2018/conferences/la-donnee-graphique-avec-html-et-css.php">Paris Web 2018</a>
							</li>
						</ul>
					</div>
				</div>
			</aside>

			<footer class="mw--site mod txtcenter center" role="contentinfo" itemscope itemtype="https://schema.org/Person">
				<ul class="ffeeeedd--contact ul-reset p-reset mt0 print-hidden">
					<li class="inbl pa1" itemscope itemprop="contactPoint">
						<a class="skip inbl ir ffeeeedd--sprite ffeeeedd--sprite__github" href="https://github.com/ffoodd" itemprop="url" title="GaÃ«l Poupard sur GitHub">
							<span itemprop="name">GitHub</span>
						</a>
					</li>
					<li class="inbl pa1" itemscope itemprop="contactPoint">
						<a class="skip inbl ir ffeeeedd--sprite ffeeeedd--sprite__dribble" href="https://dribbble.com/ffoodd" itemprop="url" title="GaÃ«l Poupard sur Dribbble">
							<span itemprop="name">Dribbble</span>
						</a>
					</li>
					<li class="inbl pa1" itemscope itemprop="contactPoint">
						<a class="skip inbl ir ffeeeedd--sprite ffeeeedd--sprite__linkedin" href="https://www.linkedin.com/pub/ga%C3%ABl-poupard/30/17b/401" itemprop="url" title="GaÃ«l Poupard sur LinkedIn">
							<span itemprop="name">LinkedIn</span>
						</a>
					</li>
					<li class="inbl pa1" itemscope itemprop="contactPoint">
						<a class="skip inbl ir ffeeeedd--sprite ffeeeedd--sprite__behance" href="https://www.behance.net/ffoodd" itemprop="url" title="GaÃ«l Poupard sur Behance">
							<span itemprop="name">Behance</span>
						</a>
					</li>
					<li class="inbl pa1" itemscope itemprop="contactPoint">
						<a class="skip inbl ir ffeeeedd--sprite ffeeeedd--sprite__rss" href="/feed/" itemprop="url" title="La vie en #ffoodd | Flux RSS">
							<span itemprop="name">RSS</span>
						</a>
					</li>
				</ul>

				<small>
					&copy; 2018 La vie en #ffoodd &mdash; Design et intÃ©gration par <span itemprop="name">GaÃ«l Poupard</span> &mdash; <a href="/mentions-legales/">Mentions lÃ©gales</a>
					<br />
					Sauf mention contraire, lâ€™ensemble du contenu est sous <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/3.0/fr/">Licence <abbr lang="en" title="Creative Commons">CC</abbr> <abbr lang="en" title="Attribution">BY</abbr>-<abbr lang="en" title="Non Commercial">NC</abbr>-<abbr lang="en" title="Share Alike">SA</abbr></a>.
				</small>

				<meta itemprop="jobTitle" content="Webdesigner et intÃ©grateur web">
				<meta itemprop="worksFor" content="onepoint">
			</footer><!-- / contentinfo -->
		</div>
	</body>
</html>
